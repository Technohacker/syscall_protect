use kernel::prelude::*;

pub(crate) fn print_syscall(num: u32) {
    let name = match num {
        kernel::bindings::__NR_read => "read",
        kernel::bindings::__NR_write => "write",
        kernel::bindings::__NR_open => "open",
        kernel::bindings::__NR_close => "close",
        kernel::bindings::__NR_stat => "stat",
        kernel::bindings::__NR_fstat => "fstat",
        kernel::bindings::__NR_lstat => "lstat",
        kernel::bindings::__NR_poll => "poll",
        kernel::bindings::__NR_lseek => "lseek",
        kernel::bindings::__NR_mmap => "mmap",
        kernel::bindings::__NR_mprotect => "mprotect",
        kernel::bindings::__NR_munmap => "munmap",
        kernel::bindings::__NR_brk => "brk",
        kernel::bindings::__NR_rt_sigaction => "rt_sigaction",
        kernel::bindings::__NR_rt_sigprocmask => "rt_sigprocmask",
        kernel::bindings::__NR_rt_sigreturn => "rt_sigreturn",
        kernel::bindings::__NR_ioctl => "ioctl",
        kernel::bindings::__NR_pread64 => "pread64",
        kernel::bindings::__NR_pwrite64 => "pwrite64",
        kernel::bindings::__NR_readv => "readv",
        kernel::bindings::__NR_writev => "writev",
        kernel::bindings::__NR_access => "access",
        kernel::bindings::__NR_pipe => "pipe",
        kernel::bindings::__NR_select => "select",
        kernel::bindings::__NR_sched_yield => "sched_yield",
        kernel::bindings::__NR_mremap => "mremap",
        kernel::bindings::__NR_msync => "msync",
        kernel::bindings::__NR_mincore => "mincore",
        kernel::bindings::__NR_madvise => "madvise",
        kernel::bindings::__NR_shmget => "shmget",
        kernel::bindings::__NR_shmat => "shmat",
        kernel::bindings::__NR_shmctl => "shmctl",
        kernel::bindings::__NR_dup => "dup",
        kernel::bindings::__NR_dup2 => "dup2",
        kernel::bindings::__NR_pause => "pause",
        kernel::bindings::__NR_nanosleep => "nanosleep",
        kernel::bindings::__NR_getitimer => "getitimer",
        kernel::bindings::__NR_alarm => "alarm",
        kernel::bindings::__NR_setitimer => "setitimer",
        kernel::bindings::__NR_getpid => "getpid",
        kernel::bindings::__NR_sendfile => "sendfile",
        kernel::bindings::__NR_socket => "socket",
        kernel::bindings::__NR_connect => "connect",
        kernel::bindings::__NR_accept => "accept",
        kernel::bindings::__NR_sendto => "sendto",
        kernel::bindings::__NR_recvfrom => "recvfrom",
        kernel::bindings::__NR_sendmsg => "sendmsg",
        kernel::bindings::__NR_recvmsg => "recvmsg",
        kernel::bindings::__NR_shutdown => "shutdown",
        kernel::bindings::__NR_bind => "bind",
        kernel::bindings::__NR_listen => "listen",
        kernel::bindings::__NR_getsockname => "getsockname",
        kernel::bindings::__NR_getpeername => "getpeername",
        kernel::bindings::__NR_socketpair => "socketpair",
        kernel::bindings::__NR_setsockopt => "setsockopt",
        kernel::bindings::__NR_getsockopt => "getsockopt",
        kernel::bindings::__NR_clone => "clone",
        kernel::bindings::__NR_fork => "fork",
        kernel::bindings::__NR_vfork => "vfork",
        kernel::bindings::__NR_execve => "execve",
        kernel::bindings::__NR_exit => "exit",
        kernel::bindings::__NR_wait4 => "wait4",
        kernel::bindings::__NR_kill => "kill",
        kernel::bindings::__NR_uname => "uname",
        kernel::bindings::__NR_semget => "semget",
        kernel::bindings::__NR_semop => "semop",
        kernel::bindings::__NR_semctl => "semctl",
        kernel::bindings::__NR_shmdt => "shmdt",
        kernel::bindings::__NR_msgget => "msgget",
        kernel::bindings::__NR_msgsnd => "msgsnd",
        kernel::bindings::__NR_msgrcv => "msgrcv",
        kernel::bindings::__NR_msgctl => "msgctl",
        kernel::bindings::__NR_fcntl => "fcntl",
        kernel::bindings::__NR_flock => "flock",
        kernel::bindings::__NR_fsync => "fsync",
        kernel::bindings::__NR_fdatasync => "fdatasync",
        kernel::bindings::__NR_truncate => "truncate",
        kernel::bindings::__NR_ftruncate => "ftruncate",
        kernel::bindings::__NR_getdents => "getdents",
        kernel::bindings::__NR_getcwd => "getcwd",
        kernel::bindings::__NR_chdir => "chdir",
        kernel::bindings::__NR_fchdir => "fchdir",
        kernel::bindings::__NR_rename => "rename",
        kernel::bindings::__NR_mkdir => "mkdir",
        kernel::bindings::__NR_rmdir => "rmdir",
        kernel::bindings::__NR_creat => "creat",
        kernel::bindings::__NR_link => "link",
        kernel::bindings::__NR_unlink => "unlink",
        kernel::bindings::__NR_symlink => "symlink",
        kernel::bindings::__NR_readlink => "readlink",
        kernel::bindings::__NR_chmod => "chmod",
        kernel::bindings::__NR_fchmod => "fchmod",
        kernel::bindings::__NR_chown => "chown",
        kernel::bindings::__NR_fchown => "fchown",
        kernel::bindings::__NR_lchown => "lchown",
        kernel::bindings::__NR_umask => "umask",
        kernel::bindings::__NR_gettimeofday => "gettimeofday",
        kernel::bindings::__NR_getrlimit => "getrlimit",
        kernel::bindings::__NR_getrusage => "getrusage",
        kernel::bindings::__NR_sysinfo => "sysinfo",
        kernel::bindings::__NR_times => "times",
        kernel::bindings::__NR_ptrace => "ptrace",
        kernel::bindings::__NR_getuid => "getuid",
        kernel::bindings::__NR_syslog => "syslog",
        kernel::bindings::__NR_getgid => "getgid",
        kernel::bindings::__NR_setuid => "setuid",
        kernel::bindings::__NR_setgid => "setgid",
        kernel::bindings::__NR_geteuid => "geteuid",
        kernel::bindings::__NR_getegid => "getegid",
        kernel::bindings::__NR_setpgid => "setpgid",
        kernel::bindings::__NR_getppid => "getppid",
        kernel::bindings::__NR_getpgrp => "getpgrp",
        kernel::bindings::__NR_setsid => "setsid",
        kernel::bindings::__NR_setreuid => "setreuid",
        kernel::bindings::__NR_setregid => "setregid",
        kernel::bindings::__NR_getgroups => "getgroups",
        kernel::bindings::__NR_setgroups => "setgroups",
        kernel::bindings::__NR_setresuid => "setresuid",
        kernel::bindings::__NR_getresuid => "getresuid",
        kernel::bindings::__NR_setresgid => "setresgid",
        kernel::bindings::__NR_getresgid => "getresgid",
        kernel::bindings::__NR_getpgid => "getpgid",
        kernel::bindings::__NR_setfsuid => "setfsuid",
        kernel::bindings::__NR_setfsgid => "setfsgid",
        kernel::bindings::__NR_getsid => "getsid",
        kernel::bindings::__NR_capget => "capget",
        kernel::bindings::__NR_capset => "capset",
        kernel::bindings::__NR_rt_sigpending => "rt_sigpending",
        kernel::bindings::__NR_rt_sigtimedwait => "rt_sigtimedwait",
        kernel::bindings::__NR_rt_sigqueueinfo => "rt_sigqueueinfo",
        kernel::bindings::__NR_rt_sigsuspend => "rt_sigsuspend",
        kernel::bindings::__NR_sigaltstack => "sigaltstack",
        kernel::bindings::__NR_utime => "utime",
        kernel::bindings::__NR_mknod => "mknod",
        kernel::bindings::__NR_uselib => "uselib",
        kernel::bindings::__NR_personality => "personality",
        kernel::bindings::__NR_ustat => "ustat",
        kernel::bindings::__NR_statfs => "statfs",
        kernel::bindings::__NR_fstatfs => "fstatfs",
        kernel::bindings::__NR_sysfs => "sysfs",
        kernel::bindings::__NR_getpriority => "getpriority",
        kernel::bindings::__NR_setpriority => "setpriority",
        kernel::bindings::__NR_sched_setparam => "sched_setparam",
        kernel::bindings::__NR_sched_getparam => "sched_getparam",
        kernel::bindings::__NR_sched_setscheduler => "sched_setscheduler",
        kernel::bindings::__NR_sched_getscheduler => "sched_getscheduler",
        kernel::bindings::__NR_sched_get_priority_max => "sched_get_priority_max",
        kernel::bindings::__NR_sched_get_priority_min => "sched_get_priority_min",
        kernel::bindings::__NR_sched_rr_get_interval => "sched_rr_get_interval",
        kernel::bindings::__NR_mlock => "mlock",
        kernel::bindings::__NR_munlock => "munlock",
        kernel::bindings::__NR_mlockall => "mlockall",
        kernel::bindings::__NR_munlockall => "munlockall",
        kernel::bindings::__NR_vhangup => "vhangup",
        kernel::bindings::__NR_modify_ldt => "modify_ldt",
        kernel::bindings::__NR_pivot_root => "pivot_root",
        kernel::bindings::__NR__sysctl => "_sysctl",
        kernel::bindings::__NR_prctl => "prctl",
        kernel::bindings::__NR_arch_prctl => "arch_prctl",
        kernel::bindings::__NR_adjtimex => "adjtimex",
        kernel::bindings::__NR_setrlimit => "setrlimit",
        kernel::bindings::__NR_chroot => "chroot",
        kernel::bindings::__NR_sync => "sync",
        kernel::bindings::__NR_acct => "acct",
        kernel::bindings::__NR_settimeofday => "settimeofday",
        kernel::bindings::__NR_mount => "mount",
        kernel::bindings::__NR_umount2 => "umount2",
        kernel::bindings::__NR_swapon => "swapon",
        kernel::bindings::__NR_swapoff => "swapoff",
        kernel::bindings::__NR_reboot => "reboot",
        kernel::bindings::__NR_sethostname => "sethostname",
        kernel::bindings::__NR_setdomainname => "setdomainname",
        kernel::bindings::__NR_iopl => "iopl",
        kernel::bindings::__NR_ioperm => "ioperm",
        kernel::bindings::__NR_create_module => "create_module",
        kernel::bindings::__NR_init_module => "init_module",
        kernel::bindings::__NR_delete_module => "delete_module",
        kernel::bindings::__NR_get_kernel_syms => "get_kernel_syms",
        kernel::bindings::__NR_query_module => "query_module",
        kernel::bindings::__NR_quotactl => "quotactl",
        kernel::bindings::__NR_nfsservctl => "nfsservctl",
        kernel::bindings::__NR_getpmsg => "getpmsg",
        kernel::bindings::__NR_putpmsg => "putpmsg",
        kernel::bindings::__NR_afs_syscall => "afs_syscall",
        kernel::bindings::__NR_tuxcall => "tuxcall",
        kernel::bindings::__NR_security => "security",
        kernel::bindings::__NR_gettid => "gettid",
        kernel::bindings::__NR_readahead => "readahead",
        kernel::bindings::__NR_setxattr => "setxattr",
        kernel::bindings::__NR_lsetxattr => "lsetxattr",
        kernel::bindings::__NR_fsetxattr => "fsetxattr",
        kernel::bindings::__NR_getxattr => "getxattr",
        kernel::bindings::__NR_lgetxattr => "lgetxattr",
        kernel::bindings::__NR_fgetxattr => "fgetxattr",
        kernel::bindings::__NR_listxattr => "listxattr",
        kernel::bindings::__NR_llistxattr => "llistxattr",
        kernel::bindings::__NR_flistxattr => "flistxattr",
        kernel::bindings::__NR_removexattr => "removexattr",
        kernel::bindings::__NR_lremovexattr => "lremovexattr",
        kernel::bindings::__NR_fremovexattr => "fremovexattr",
        kernel::bindings::__NR_tkill => "tkill",
        kernel::bindings::__NR_time => "time",
        kernel::bindings::__NR_futex => "futex",
        kernel::bindings::__NR_sched_setaffinity => "sched_setaffinity",
        kernel::bindings::__NR_sched_getaffinity => "sched_getaffinity",
        kernel::bindings::__NR_set_thread_area => "set_thread_area",
        kernel::bindings::__NR_io_setup => "io_setup",
        kernel::bindings::__NR_io_destroy => "io_destroy",
        kernel::bindings::__NR_io_getevents => "io_getevents",
        kernel::bindings::__NR_io_submit => "io_submit",
        kernel::bindings::__NR_io_cancel => "io_cancel",
        kernel::bindings::__NR_get_thread_area => "get_thread_area",
        kernel::bindings::__NR_lookup_dcookie => "lookup_dcookie",
        kernel::bindings::__NR_epoll_create => "epoll_create",
        kernel::bindings::__NR_epoll_ctl_old => "epoll_ctl_old",
        kernel::bindings::__NR_epoll_wait_old => "epoll_wait_old",
        kernel::bindings::__NR_remap_file_pages => "remap_file_pages",
        kernel::bindings::__NR_getdents64 => "getdents64",
        kernel::bindings::__NR_set_tid_address => "set_tid_address",
        kernel::bindings::__NR_restart_syscall => "restart_syscall",
        kernel::bindings::__NR_semtimedop => "semtimedop",
        kernel::bindings::__NR_fadvise64 => "fadvise64",
        kernel::bindings::__NR_timer_create => "timer_create",
        kernel::bindings::__NR_timer_settime => "timer_settime",
        kernel::bindings::__NR_timer_gettime => "timer_gettime",
        kernel::bindings::__NR_timer_getoverrun => "timer_getoverrun",
        kernel::bindings::__NR_timer_delete => "timer_delete",
        kernel::bindings::__NR_clock_settime => "clock_settime",
        kernel::bindings::__NR_clock_gettime => "clock_gettime",
        kernel::bindings::__NR_clock_getres => "clock_getres",
        kernel::bindings::__NR_clock_nanosleep => "clock_nanosleep",
        kernel::bindings::__NR_exit_group => "exit_group",
        kernel::bindings::__NR_epoll_wait => "epoll_wait",
        kernel::bindings::__NR_epoll_ctl => "epoll_ctl",
        kernel::bindings::__NR_tgkill => "tgkill",
        kernel::bindings::__NR_utimes => "utimes",
        kernel::bindings::__NR_vserver => "vserver",
        kernel::bindings::__NR_mbind => "mbind",
        kernel::bindings::__NR_set_mempolicy => "set_mempolicy",
        kernel::bindings::__NR_get_mempolicy => "get_mempolicy",
        kernel::bindings::__NR_mq_open => "mq_open",
        kernel::bindings::__NR_mq_unlink => "mq_unlink",
        kernel::bindings::__NR_mq_timedsend => "mq_timedsend",
        kernel::bindings::__NR_mq_timedreceive => "mq_timedreceive",
        kernel::bindings::__NR_mq_notify => "mq_notify",
        kernel::bindings::__NR_mq_getsetattr => "mq_getsetattr",
        kernel::bindings::__NR_kexec_load => "kexec_load",
        kernel::bindings::__NR_waitid => "waitid",
        kernel::bindings::__NR_add_key => "add_key",
        kernel::bindings::__NR_request_key => "request_key",
        kernel::bindings::__NR_keyctl => "keyctl",
        kernel::bindings::__NR_ioprio_set => "ioprio_set",
        kernel::bindings::__NR_ioprio_get => "ioprio_get",
        kernel::bindings::__NR_inotify_init => "inotify_init",
        kernel::bindings::__NR_inotify_add_watch => "inotify_add_watch",
        kernel::bindings::__NR_inotify_rm_watch => "inotify_rm_watch",
        kernel::bindings::__NR_migrate_pages => "migrate_pages",
        kernel::bindings::__NR_openat => "openat",
        kernel::bindings::__NR_mkdirat => "mkdirat",
        kernel::bindings::__NR_mknodat => "mknodat",
        kernel::bindings::__NR_fchownat => "fchownat",
        kernel::bindings::__NR_futimesat => "futimesat",
        kernel::bindings::__NR_newfstatat => "newfstatat",
        kernel::bindings::__NR_unlinkat => "unlinkat",
        kernel::bindings::__NR_renameat => "renameat",
        kernel::bindings::__NR_linkat => "linkat",
        kernel::bindings::__NR_symlinkat => "symlinkat",
        kernel::bindings::__NR_readlinkat => "readlinkat",
        kernel::bindings::__NR_fchmodat => "fchmodat",
        kernel::bindings::__NR_faccessat => "faccessat",
        kernel::bindings::__NR_pselect6 => "pselect6",
        kernel::bindings::__NR_ppoll => "ppoll",
        kernel::bindings::__NR_unshare => "unshare",
        kernel::bindings::__NR_set_robust_list => "set_robust_list",
        kernel::bindings::__NR_get_robust_list => "get_robust_list",
        kernel::bindings::__NR_splice => "splice",
        kernel::bindings::__NR_tee => "tee",
        kernel::bindings::__NR_sync_file_range => "sync_file_range",
        kernel::bindings::__NR_vmsplice => "vmsplice",
        kernel::bindings::__NR_move_pages => "move_pages",
        kernel::bindings::__NR_utimensat => "utimensat",
        kernel::bindings::__NR_epoll_pwait => "epoll_pwait",
        kernel::bindings::__NR_signalfd => "signalfd",
        kernel::bindings::__NR_timerfd_create => "timerfd_create",
        kernel::bindings::__NR_eventfd => "eventfd",
        kernel::bindings::__NR_fallocate => "fallocate",
        kernel::bindings::__NR_timerfd_settime => "timerfd_settime",
        kernel::bindings::__NR_timerfd_gettime => "timerfd_gettime",
        kernel::bindings::__NR_accept4 => "accept4",
        kernel::bindings::__NR_signalfd4 => "signalfd4",
        kernel::bindings::__NR_eventfd2 => "eventfd2",
        kernel::bindings::__NR_epoll_create1 => "epoll_create1",
        kernel::bindings::__NR_dup3 => "dup3",
        kernel::bindings::__NR_pipe2 => "pipe2",
        kernel::bindings::__NR_inotify_init1 => "inotify_init1",
        kernel::bindings::__NR_preadv => "preadv",
        kernel::bindings::__NR_pwritev => "pwritev",
        kernel::bindings::__NR_rt_tgsigqueueinfo => "rt_tgsigqueueinfo",
        kernel::bindings::__NR_perf_event_open => "perf_event_open",
        kernel::bindings::__NR_recvmmsg => "recvmmsg",
        kernel::bindings::__NR_fanotify_init => "fanotify_init",
        kernel::bindings::__NR_fanotify_mark => "fanotify_mark",
        kernel::bindings::__NR_prlimit64 => "prlimit64",
        kernel::bindings::__NR_name_to_handle_at => "name_to_handle_at",
        kernel::bindings::__NR_open_by_handle_at => "open_by_handle_at",
        kernel::bindings::__NR_clock_adjtime => "clock_adjtime",
        kernel::bindings::__NR_syncfs => "syncfs",
        kernel::bindings::__NR_sendmmsg => "sendmmsg",
        kernel::bindings::__NR_setns => "setns",
        kernel::bindings::__NR_getcpu => "getcpu",
        kernel::bindings::__NR_process_vm_readv => "process_vm_readv",
        kernel::bindings::__NR_process_vm_writev => "process_vm_writev",
        kernel::bindings::__NR_kcmp => "kcmp",
        kernel::bindings::__NR_finit_module => "finit_module",
        kernel::bindings::__NR_sched_setattr => "sched_setattr",
        kernel::bindings::__NR_sched_getattr => "sched_getattr",
        kernel::bindings::__NR_renameat2 => "renameat2",
        kernel::bindings::__NR_seccomp => "seccomp",
        kernel::bindings::__NR_getrandom => "getrandom",
        kernel::bindings::__NR_memfd_create => "memfd_create",
        kernel::bindings::__NR_kexec_file_load => "kexec_file_load",
        kernel::bindings::__NR_bpf => "bpf",
        kernel::bindings::__NR_execveat => "execveat",
        kernel::bindings::__NR_userfaultfd => "userfaultfd",
        kernel::bindings::__NR_membarrier => "membarrier",
        kernel::bindings::__NR_mlock2 => "mlock2",
        kernel::bindings::__NR_copy_file_range => "copy_file_range",
        kernel::bindings::__NR_preadv2 => "preadv2",
        kernel::bindings::__NR_pwritev2 => "pwritev2",
        kernel::bindings::__NR_pkey_mprotect => "pkey_mprotect",
        kernel::bindings::__NR_pkey_alloc => "pkey_alloc",
        kernel::bindings::__NR_pkey_free => "pkey_free",
        kernel::bindings::__NR_statx => "statx",
        kernel::bindings::__NR_io_pgetevents => "io_pgetevents",
        kernel::bindings::__NR_rseq => "rseq",
        kernel::bindings::__NR_pidfd_send_signal => "pidfd_send_signal",
        kernel::bindings::__NR_io_uring_setup => "io_uring_setup",
        kernel::bindings::__NR_io_uring_enter => "io_uring_enter",
        kernel::bindings::__NR_io_uring_register => "io_uring_register",
        kernel::bindings::__NR_open_tree => "open_tree",
        kernel::bindings::__NR_move_mount => "move_mount",
        kernel::bindings::__NR_fsopen => "fsopen",
        kernel::bindings::__NR_fsconfig => "fsconfig",
        kernel::bindings::__NR_fsmount => "fsmount",
        kernel::bindings::__NR_fspick => "fspick",
        kernel::bindings::__NR_pidfd_open => "pidfd_open",
        kernel::bindings::__NR_clone3 => "clone3",
        kernel::bindings::__NR_close_range => "close_range",
        kernel::bindings::__NR_openat2 => "openat2",
        kernel::bindings::__NR_pidfd_getfd => "pidfd_getfd",
        kernel::bindings::__NR_faccessat2 => "faccessat2",
        kernel::bindings::__NR_process_madvise => "process_madvise",
        kernel::bindings::__NR_epoll_pwait2 => "epoll_pwait2",
        kernel::bindings::__NR_mount_setattr => "mount_setattr",
        kernel::bindings::__NR_quotactl_fd => "quotactl_fd",
        kernel::bindings::__NR_landlock_create_ruleset => "landlock_create_ruleset",
        kernel::bindings::__NR_landlock_add_rule => "landlock_add_rule",
        kernel::bindings::__NR_landlock_restrict_self => "landlock_restrict_self",
        kernel::bindings::__NR_memfd_secret => "memfd_secret",
        kernel::bindings::__NR_process_mrelease => "process_mrelease",
        kernel::bindings::__NR_futex_waitv => "futex_waitv",
        kernel::bindings::__NR_set_mempolicy_home_node => "set_mempolicy_home_node",
        kernel::bindings::__NR_cachestat => "cachestat",
        kernel::bindings::__NR_fchmodat2 => "fchmodat2",
        kernel::bindings::__NR_map_shadow_stack => "map_shadow_stack",
        kernel::bindings::__NR_futex_wake => "futex_wake",
        kernel::bindings::__NR_futex_wait => "futex_wait",
        kernel::bindings::__NR_futex_requeue => "futex_requeue",
        x => {
            pr_warn!("Unknown syscall: {x}");
            return;
        },
    };

    pr_info!("Syscall: {name}");
}